!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";var n=this&&this.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}},o=this&&this.__await||function(t){return this instanceof o?(this.v=t,this):new o(t)},i=this&&this.__asyncGenerator||function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(t,e||[]),s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(t){i[t]&&(n[t]=function(e){return new Promise(function(r,n){s.push([t,e,r,n])>1||c(t,e)})})}function c(t,e){try{!function(t){t.value instanceof o?Promise.resolve(t.value.v).then(u,h):f(s[0][2],t)}(i[t](e))}catch(t){f(s[0][3],t)}}function u(t){c("next",t)}function h(t){c("throw",t)}function f(t,e){t(e),s.shift(),s.length&&c(s[0][0],s[0][1])}};Object.defineProperty(e,"__esModule",{value:!0}),r(1);const s=new Map([["b","black"],["e","brown"],["r","red"],["o","orange"],["y","yellow"],["g","green"],["l","blue"],["v","violet"],["a","grey"],["w","white"],["z","gold"],["x","silver"]]);new class{constructor(t){this.container=t,window.addEventListener("keypress",t=>{if(this.keyHandler&&!this.keyHandler(t.key))return t.preventDefault(),!1},!0);const e=document.createElement("section");e.className="stats",this.container.appendChild(e),this.stats=e;const r=document.createElement("section");r.className="colorbar",this.container.appendChild(r),this.colorBar=r;const n=document.createElement("section");n.className="error",this.container.appendChild(n),this.error=n,this.container.appendChild(this.generateLegend())}async run(){var t,e;try{for(var r,o=n(this.images());!(r=await o.next()).done;){const t=r.value,e=await this.fetchStats();let n;for(this.stats.textContent=JSON.stringify(e),this.error.textContent="";;){const e=await this.prompt(t,n);if(!1===e)await this.skip(t);else try{await this.submit(t,e)}catch(t){this.error.textContent=t.message,n=e;continue}break}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=o.return)&&await e.call(o)}finally{if(t)throw t.error}}}generateLegend(){const t=document.createElement("section");t.className="legend";const e=document.createElement("h3");e.textContent="Key codes",t.appendChild(e);const r=document.createElement("ul");t.appendChild(r);for(const[t,e]of s){const n=document.createElement("li"),o=document.createElement("b");o.textContent=`"${t}"`;const i=document.createElement("span");i.textContent=` - ${e}`,n.appendChild(o),n.appendChild(i),r.appendChild(n)}return t}async prompt(t,e){const r=await this.loadImage(t);this.image&&this.container.removeChild(this.image),this.container.insertBefore(r,this.colorBar),this.image=r,this.colorBar.innerHTML="";const n=[],o=[],i=t=>{const e=document.createElement("span");e.textContent=t,e.className=t,this.colorBar.appendChild(e),n.push(t),o.push(e)};if(e)for(const t of e)i(t);return new Promise(t=>{this.keyHandler=(e=>{if(s.has(e))i(s.get(e));else if("Backspace"===e)(()=>{const t=o.pop();t&&t.remove(),n.pop()})();else if("Enter"===e)this.keyHandler=void 0,t(n);else{if("Escape"!==e)return!0;t(!1)}return!1})})}async fetchStats(){const t=await fetch("/api/stats");return await t.json()}images(){return i(this,arguments,function*(){for(;;){const t=yield o(fetch("/api/next")),e=yield o(t.json());if(e.done)return yield o(void 0);yield yield o(e.hash)}})}async loadImage(t){const e=await new Promise((e,r)=>{const n=document.createElement("img");n.onload=(()=>e(n)),n.onerror=(()=>r(new Error("Failed to load image"))),n.src=`/images/${t}.jpg`}),r=256/Math.max(e.width,e.height);return e.width*=r,e.height*=r,e}async skip(t){const e=await fetch(`/api/label/${t}`,{method:"DELETE"});return await e.json()}async submit(t,e){const r=await fetch(`/api/label/${t}`,{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify({colors:e})}),n=await r.json();if(n.error)throw new Error(n.error)}}(document.getElementById("content")).run().catch(t=>{console.error(t)})},function(t,e){!function(t){"use strict";if(!t.fetch){var e={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(e.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],n=function(t){return t&&DataView.prototype.isPrototypeOf(t)},o=ArrayBuffer.isView||function(t){return t&&r.indexOf(Object.prototype.toString.call(t))>-1};h.prototype.append=function(t,e){t=a(t),e=c(e);var r=this.map[t];this.map[t]=r?r+","+e:e},h.prototype.delete=function(t){delete this.map[a(t)]},h.prototype.get=function(t){return t=a(t),this.has(t)?this.map[t]:null},h.prototype.has=function(t){return this.map.hasOwnProperty(a(t))},h.prototype.set=function(t,e){this.map[a(t)]=c(e)},h.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},h.prototype.keys=function(){var t=[];return this.forEach(function(e,r){t.push(r)}),u(t)},h.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),u(t)},h.prototype.entries=function(){var t=[];return this.forEach(function(e,r){t.push([r,e])}),u(t)},e.iterable&&(h.prototype[Symbol.iterator]=h.prototype.entries);var i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},p.call(m.prototype),p.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},w.error=function(){var t=new w(null,{status:0,statusText:""});return t.type="error",t};var s=[301,302,303,307,308];w.redirect=function(t,e){if(-1===s.indexOf(e))throw new RangeError("Invalid status code");return new w(null,{status:e,headers:{location:t}})},t.Headers=h,t.Request=m,t.Response=w,t.fetch=function(t,r){return new Promise(function(n,o){var i=new m(t,r),s=new XMLHttpRequest;s.onload=function(){var t={status:s.status,statusText:s.statusText,headers:function(t){var e=new h;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var r=t.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();e.append(n,o)}}),e}(s.getAllResponseHeaders()||"")};t.url="responseURL"in s?s.responseURL:t.headers.get("X-Request-URL");var e="response"in s?s.response:s.responseText;n(new w(e,t))},s.onerror=function(){o(new TypeError("Network request failed"))},s.ontimeout=function(){o(new TypeError("Network request failed"))},s.open(i.method,i.url,!0),"include"===i.credentials?s.withCredentials=!0:"omit"===i.credentials&&(s.withCredentials=!1),"responseType"in s&&e.blob&&(s.responseType="blob"),i.headers.forEach(function(t,e){s.setRequestHeader(e,t)}),s.send(void 0===i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0}function a(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function c(t){return"string"!=typeof t&&(t=String(t)),t}function u(t){var r={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e.iterable&&(r[Symbol.iterator]=function(){return r}),r}function h(t){this.map={},t instanceof h?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function f(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function l(t){return new Promise(function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function d(t){var e=new FileReader,r=l(e);return e.readAsArrayBuffer(t),r}function y(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function p(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(e.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(e.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(e.arrayBuffer&&e.blob&&n(t))this._bodyArrayBuffer=y(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!e.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!o(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=y(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},e.blob&&(this.blob=function(){var t=f(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var t=f(this);if(t)return t;if(this._bodyBlob)return function(t){var e=new FileReader,r=l(e);return e.readAsText(t),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},e.formData&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}function m(t,e){var r=(e=e||{}).body;if(t instanceof m){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new h(t.headers)),this.method=t.method,this.mode=t.mode,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new h(e.headers)),this.method=function(t){var e=t.toUpperCase();return i.indexOf(e)>-1?e:t}(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function b(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(o))}}),e}function w(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new h(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!=typeof self?self:this)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NsYXNzaWZ5LWZyb250ZW5kLnRzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy93aGF0d2ctZmV0Y2gvZmV0Y2guanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJLRVlfVE9fQ09MT1JfTUFQIiwiTWFwIiwiW29iamVjdCBPYmplY3RdIiwiY29udGFpbmVyIiwidGhpcyIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwia2V5SGFuZGxlciIsInByZXZlbnREZWZhdWx0Iiwic3RhdHMiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJhcHBlbmRDaGlsZCIsImNvbG9yQmFyIiwiZXJyb3IiLCJnZW5lcmF0ZUxlZ2VuZCIsIl9jIiwiX2IiLCJfX2FzeW5jVmFsdWVzIiwiaW1hZ2VzIiwibmV4dCIsImRvbmUiLCJpbWFnZSIsImZldGNoU3RhdHMiLCJjb2xvcnMiLCJ0ZXh0Q29udGVudCIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZXN1bHQiLCJwcm9tcHQiLCJza2lwIiwic3VibWl0IiwibWVzc2FnZSIsInJlcyIsImhlYWRlciIsInVsIiwibGkiLCJrZXlXcmFwIiwidmFsdWVXcmFwIiwiaGFzaCIsInByZXZpb3VzIiwibG9hZEltYWdlIiwicmVtb3ZlQ2hpbGQiLCJpbnNlcnRCZWZvcmUiLCJpbm5lckhUTUwiLCJlbGVtcyIsImFkZENvbG9yIiwiY29sb3IiLCJlbGVtIiwicHVzaCIsIlByb21pc2UiLCJyZXNvbHZlIiwiaGFzIiwicG9wIiwicmVtb3ZlIiwicG9wQ29sb3IiLCJ1bmRlZmluZWQiLCJmZXRjaCIsImpzb24iLCJfX2F3YWl0IiwiaW1nIiwicmVqZWN0Iiwib25sb2FkIiwib25lcnJvciIsIkVycm9yIiwic3JjIiwic2NhbGUiLCJNYXRoIiwibWF4Iiwid2lkdGgiLCJoZWlnaHQiLCJtZXRob2QiLCJoZWFkZXJzIiwiY29udGVudC10eXBlIiwiYm9keSIsImdldEVsZW1lbnRCeUlkIiwicnVuIiwiY2F0Y2giLCJjb25zb2xlIiwic2VsZiIsInN1cHBvcnQiLCJzZWFyY2hQYXJhbXMiLCJpdGVyYWJsZSIsImJsb2IiLCJCbG9iIiwiZm9ybURhdGEiLCJhcnJheUJ1ZmZlciIsInZpZXdDbGFzc2VzIiwiaXNEYXRhVmlldyIsIm9iaiIsIkRhdGFWaWV3IiwiaXNQcm90b3R5cGVPZiIsImlzQXJyYXlCdWZmZXJWaWV3IiwiQXJyYXlCdWZmZXIiLCJpc1ZpZXciLCJpbmRleE9mIiwidG9TdHJpbmciLCJIZWFkZXJzIiwiYXBwZW5kIiwibm9ybWFsaXplTmFtZSIsIm5vcm1hbGl6ZVZhbHVlIiwib2xkVmFsdWUiLCJtYXAiLCJzZXQiLCJmb3JFYWNoIiwiY2FsbGJhY2siLCJ0aGlzQXJnIiwia2V5cyIsIml0ZW1zIiwiaXRlcmF0b3JGb3IiLCJ2YWx1ZXMiLCJlbnRyaWVzIiwiaXRlcmF0b3IiLCJtZXRob2RzIiwiUmVxdWVzdCIsImNsb25lIiwiX2JvZHlJbml0IiwiQm9keSIsIlJlc3BvbnNlIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsInVybCIsInJlc3BvbnNlIiwidHlwZSIsInJlZGlyZWN0U3RhdHVzZXMiLCJyZWRpcmVjdCIsIlJhbmdlRXJyb3IiLCJsb2NhdGlvbiIsImlucHV0IiwiaW5pdCIsInJlcXVlc3QiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsIm9wdGlvbnMiLCJyYXdIZWFkZXJzIiwicmVwbGFjZSIsInNwbGl0IiwibGluZSIsInBhcnRzIiwic2hpZnQiLCJ0cmltIiwiam9pbiIsInBhcnNlSGVhZGVycyIsImdldEFsbFJlc3BvbnNlSGVhZGVycyIsInJlc3BvbnNlVVJMIiwicmVzcG9uc2VUZXh0IiwiVHlwZUVycm9yIiwib250aW1lb3V0Iiwib3BlbiIsImNyZWRlbnRpYWxzIiwid2l0aENyZWRlbnRpYWxzIiwicmVzcG9uc2VUeXBlIiwic2V0UmVxdWVzdEhlYWRlciIsInNlbmQiLCJwb2x5ZmlsbCIsIlN0cmluZyIsInRlc3QiLCJ0b0xvd2VyQ2FzZSIsIkFycmF5IiwiaXNBcnJheSIsImdldE93blByb3BlcnR5TmFtZXMiLCJjb25zdW1lZCIsImJvZHlVc2VkIiwiZmlsZVJlYWRlclJlYWR5IiwicmVhZGVyIiwicmVhZEJsb2JBc0FycmF5QnVmZmVyIiwiRmlsZVJlYWRlciIsInByb21pc2UiLCJyZWFkQXNBcnJheUJ1ZmZlciIsImJ1ZmZlckNsb25lIiwiYnVmIiwic2xpY2UiLCJ2aWV3IiwiVWludDhBcnJheSIsImJ5dGVMZW5ndGgiLCJidWZmZXIiLCJfaW5pdEJvZHkiLCJfYm9keVRleHQiLCJfYm9keUJsb2IiLCJGb3JtRGF0YSIsIl9ib2R5Rm9ybURhdGEiLCJVUkxTZWFyY2hQYXJhbXMiLCJfYm9keUFycmF5QnVmZmVyIiwicmVqZWN0ZWQiLCJ0aGVuIiwidGV4dCIsInJlYWRBc1RleHQiLCJyZWFkQmxvYkFzVGV4dCIsImNoYXJzIiwibGVuZ3RoIiwiZnJvbUNoYXJDb2RlIiwicmVhZEFycmF5QnVmZmVyQXNUZXh0IiwiZGVjb2RlIiwicGFyc2UiLCJ1cGNhc2VkIiwidG9VcHBlckNhc2UiLCJub3JtYWxpemVNZXRob2QiLCJyZWZlcnJlciIsImZvcm0iLCJieXRlcyIsImRlY29kZVVSSUNvbXBvbmVudCIsImJvZHlJbml0Iiwib2siXSwibWFw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LG1CQUFBbk8sR0FBQW1PLG1CQUFBek4sT0FHQXVOLEVBcUJBLFNBQUFoRixFQUFBbUYsRUFBQXBFLEdBQ0FBLElBQ0FBLE1BR0FuSSxLQUFBeUgsS0FBQSxVQUNBekgsS0FBQXFILFlBQUEvRCxJQUFBNkUsRUFBQWQsT0FBQSxJQUFBYyxFQUFBZCxPQUNBckgsS0FBQXdNLEdBQUF4TSxLQUFBcUgsUUFBQSxLQUFBckgsS0FBQXFILE9BQUEsSUFDQXJILEtBQUFzSCxXQUFBLGVBQUFhLElBQUFiLFdBQUEsS0FDQXRILEtBQUFzRSxRQUFBLElBQUF5QixFQUFBb0MsRUFBQTdELFNBQ0F0RSxLQUFBdUgsSUFBQVksRUFBQVosS0FBQSxHQUNBdkgsS0FBQThLLFVBQUF5QixJQW5ZQSxDQWlkQyxvQkFBQTFILFVBQUE3RSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJpbXBvcnQgJ3doYXR3Zy1mZXRjaCdcblxuaW50ZXJmYWNlIElTdGF0cyB7XG4gIHJlYWRvbmx5IGNvbXBsZXRlOiBudW1iZXI7XG4gIHJlYWRvbmx5IHRvdGFsOiBudW1iZXI7XG59XG5cbnR5cGUgUHJvbXB0UmVzdWx0ID0gZmFsc2UgfCBSZWFkb25seUFycmF5PHN0cmluZz47XG5cbmNvbnN0IEtFWV9UT19DT0xPUl9NQVAgPSBuZXcgTWFwKFtcbiAgWyAnYicsICdibGFjaycgXSxcbiAgWyAnZScsICdicm93bicgXSxcbiAgWyAncicsICdyZWQnIF0sXG4gIFsgJ28nLCAnb3JhbmdlJyBdLFxuICBbICd5JywgJ3llbGxvdycgXSxcbiAgWyAnZycsICdncmVlbicgXSxcbiAgWyAnbCcsICdibHVlJyBdLFxuICBbICd2JywgJ3Zpb2xldCcgXSxcbiAgWyAnYScsICdncmV5JyBdLFxuICBbICd3JywgJ3doaXRlJyBdLFxuICBbICd6JywgJ2dvbGQnIF0sXG4gIFsgJ3gnLCAnc2lsdmVyJyBdLFxuXSk7XG5cbmNsYXNzIEFwcCB7XG4gIHByaXZhdGUgaW1hZ2U6IEhUTUxJbWFnZUVsZW1lbnQgfCB1bmRlZmluZWQ7XG4gIHByaXZhdGUgY29sb3JCYXI6IEhUTUxFbGVtZW50O1xuICBwcml2YXRlIHN0YXRzOiBIVE1MRWxlbWVudDtcbiAgcHJpdmF0ZSBlcnJvcjogSFRNTEVsZW1lbnQ7XG4gIHByaXZhdGUga2V5SGFuZGxlcjogKChrZXk6IHN0cmluZykgPT4gYm9vbGVhbikgfCB1bmRlZmluZWQ7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgKGUpID0+IHtcbiAgICAgIGlmICh0aGlzLmtleUhhbmRsZXIgJiYgIXRoaXMua2V5SGFuZGxlcihlLmtleSkpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSwgdHJ1ZSk7XG5cbiAgICAvLyBTdGF0c1xuICAgIGNvbnN0IHN0YXRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VjdGlvbicpO1xuICAgIHN0YXRzLmNsYXNzTmFtZSA9ICdzdGF0cyc7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZChzdGF0cyk7XG4gICAgdGhpcy5zdGF0cyA9IHN0YXRzO1xuXG4gICAgLy8gQ29sb3JzXG4gICAgY29uc3QgY29sb3JCYXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWN0aW9uJyk7XG4gICAgY29sb3JCYXIuY2xhc3NOYW1lID0gJ2NvbG9yYmFyJztcblxuICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKGNvbG9yQmFyKTtcbiAgICB0aGlzLmNvbG9yQmFyID0gY29sb3JCYXI7XG5cbiAgICAvLyBFcnJvclxuICAgIGNvbnN0IGVycm9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VjdGlvbicpO1xuICAgIGVycm9yLmNsYXNzTmFtZSA9ICdlcnJvcic7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZChlcnJvcik7XG4gICAgdGhpcy5lcnJvciA9IGVycm9yO1xuXG4gICAgLy8gTGVnZW5kXG4gICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5nZW5lcmF0ZUxlZ2VuZCgpKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBydW4oKSB7XG4gICAgZm9yIGF3YWl0IChjb25zdCBpbWFnZSBvZiB0aGlzLmltYWdlcygpKSB7XG4gICAgICBjb25zdCBzdGF0cyA9IGF3YWl0IHRoaXMuZmV0Y2hTdGF0cygpO1xuXG4gICAgICB0aGlzLnN0YXRzLnRleHRDb250ZW50ID0gSlNPTi5zdHJpbmdpZnkoc3RhdHMpO1xuICAgICAgdGhpcy5lcnJvci50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgbGV0IGNvbG9yczogUmVhZG9ubHlBcnJheTxzdHJpbmc+IHwgdW5kZWZpbmVkO1xuXG4gICAgICBmb3IgKDs7KSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucHJvbXB0KGltYWdlLCBjb2xvcnMpO1xuXG4gICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5za2lwKGltYWdlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zdWJtaXQoaW1hZ2UsIHJlc3VsdCk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gUmVwZWF0XG4gICAgICAgICAgICB0aGlzLmVycm9yLnRleHRDb250ZW50ID0gZS5tZXNzYWdlO1xuICAgICAgICAgICAgY29sb3JzID0gcmVzdWx0O1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVMZWdlbmQoKTogSFRNTEVsZW1lbnQge1xuICAgIGNvbnN0IHJlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlY3Rpb24nKTtcbiAgICByZXMuY2xhc3NOYW1lID0gJ2xlZ2VuZCc7XG5cbiAgICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xuICAgIGhlYWRlci50ZXh0Q29udGVudCA9ICdLZXkgY29kZXMnO1xuICAgIHJlcy5hcHBlbmRDaGlsZChoZWFkZXIpO1xuXG4gICAgY29uc3QgdWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xuICAgIHJlcy5hcHBlbmRDaGlsZCh1bCk7XG5cbiAgICBmb3IgKGNvbnN0IFsga2V5LCB2YWx1ZSBdIG9mIEtFWV9UT19DT0xPUl9NQVApIHtcbiAgICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcblxuICAgICAgY29uc3Qga2V5V3JhcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2InKTtcbiAgICAgIGtleVdyYXAudGV4dENvbnRlbnQgPSBgXCIke2tleX1cImA7XG5cbiAgICAgIGNvbnN0IHZhbHVlV3JhcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIHZhbHVlV3JhcC50ZXh0Q29udGVudCA9IGAgLSAke3ZhbHVlfWA7XG5cbiAgICAgIGxpLmFwcGVuZENoaWxkKGtleVdyYXApO1xuICAgICAgbGkuYXBwZW5kQ2hpbGQodmFsdWVXcmFwKTtcblxuICAgICAgdWwuYXBwZW5kQ2hpbGQobGkpO1xuICAgIH1cblxuICAgIHJldHVybiByZXM7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHByb21wdChoYXNoOiBzdHJpbmcsIHByZXZpb3VzPzogUmVhZG9ubHlBcnJheTxzdHJpbmc+KVxuICAgICAgOiBQcm9taXNlPFByb21wdFJlc3VsdD4ge1xuICAgIGNvbnN0IGltYWdlID0gYXdhaXQgdGhpcy5sb2FkSW1hZ2UoaGFzaCk7XG5cbiAgICBpZiAodGhpcy5pbWFnZSkge1xuICAgICAgdGhpcy5jb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5pbWFnZSk7XG4gICAgfVxuICAgIHRoaXMuY29udGFpbmVyLmluc2VydEJlZm9yZShpbWFnZSwgdGhpcy5jb2xvckJhcik7XG4gICAgdGhpcy5pbWFnZSA9IGltYWdlO1xuXG4gICAgdGhpcy5jb2xvckJhci5pbm5lckhUTUwgPSAnJztcblxuICAgIGNvbnN0IGNvbG9yczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBlbGVtczogSFRNTEVsZW1lbnRbXSA9IFtdO1xuXG4gICAgY29uc3QgYWRkQ29sb3IgPSAoY29sb3I6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIGVsZW0udGV4dENvbnRlbnQgPSBjb2xvcjtcbiAgICAgIGVsZW0uY2xhc3NOYW1lID0gY29sb3I7XG5cbiAgICAgIHRoaXMuY29sb3JCYXIuYXBwZW5kQ2hpbGQoZWxlbSk7XG5cbiAgICAgIGNvbG9ycy5wdXNoKGNvbG9yKTtcbiAgICAgIGVsZW1zLnB1c2goZWxlbSk7XG4gICAgfTtcblxuICAgIGNvbnN0IHBvcENvbG9yID0gKCkgPT4ge1xuICAgICAgY29uc3QgZWxlbSA9IGVsZW1zLnBvcCgpO1xuICAgICAgaWYgKGVsZW0pIHtcbiAgICAgICAgZWxlbS5yZW1vdmUoKTtcbiAgICAgIH1cbiAgICAgIGNvbG9ycy5wb3AoKTtcbiAgICB9O1xuXG4gICAgaWYgKHByZXZpb3VzKSB7XG4gICAgICBmb3IgKGNvbnN0IGNvbG9yIG9mIHByZXZpb3VzKSB7XG4gICAgICAgIGFkZENvbG9yKGNvbG9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2U8UHJvbXB0UmVzdWx0PigocmVzb2x2ZSkgPT4ge1xuICAgICAgdGhpcy5rZXlIYW5kbGVyID0gKGtleTogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmIChLRVlfVE9fQ09MT1JfTUFQLmhhcyhrZXkpKSB7XG4gICAgICAgICAgYWRkQ29sb3IoS0VZX1RPX0NPTE9SX01BUC5nZXQoa2V5KSEpO1xuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ0JhY2tzcGFjZScpIHtcbiAgICAgICAgICBwb3BDb2xvcigpO1xuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgIC8vIFN1Ym1pdFxuICAgICAgICAgIHRoaXMua2V5SGFuZGxlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICByZXNvbHZlKGNvbG9ycyk7XG4gICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgIC8vIFNraXBcbiAgICAgICAgICByZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBJZ25vcmVcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBmZXRjaFN0YXRzKCk6IFByb21pc2U8SVN0YXRzPiB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goJy9hcGkvc3RhdHMnKTtcbiAgICByZXR1cm4gYXdhaXQgcmVzLmpzb24oKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgKmltYWdlcygpIHtcbiAgICBmb3IgKDs7KSB7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCgnL2FwaS9uZXh0Jyk7XG4gICAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICAgIGlmIChqc29uLmRvbmUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB5aWVsZCBqc29uLmhhc2g7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBsb2FkSW1hZ2UoaGFzaDogc3RyaW5nKTogUHJvbWlzZTxIVE1MSW1hZ2VFbGVtZW50PiB7XG4gICAgY29uc3QgaW1nID0gYXdhaXQgbmV3IFByb21pc2U8SFRNTEltYWdlRWxlbWVudD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY29uc3QgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJykgYXMgSFRNTEltYWdlRWxlbWVudDtcblxuICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHJlc29sdmUoaW1nKTtcbiAgICAgIGltZy5vbmVycm9yID0gKCkgPT4gcmVqZWN0KG5ldyBFcnJvcignRmFpbGVkIHRvIGxvYWQgaW1hZ2UnKSk7XG5cbiAgICAgIGltZy5zcmMgPSBgL2ltYWdlcy8ke2hhc2h9LmpwZ2A7XG4gICAgfSk7XG5cbiAgICAvLyBEb3duc2NhbGVcbiAgICBjb25zdCBtYXggPSBNYXRoLm1heChpbWcud2lkdGgsIGltZy5oZWlnaHQpO1xuICAgIGNvbnN0IHNjYWxlID0gMjU2IC8gbWF4O1xuXG4gICAgaW1nLndpZHRoICo9IHNjYWxlO1xuICAgIGltZy5oZWlnaHQgKj0gc2NhbGU7XG5cbiAgICByZXR1cm4gaW1nO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBza2lwKGhhc2g6IHN0cmluZykge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGAvYXBpL2xhYmVsLyR7aGFzaH1gLCB7IG1ldGhvZDogJ0RFTEVURScgfSk7XG4gICAgcmV0dXJuIGF3YWl0IHJlcy5qc29uKCk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHN1Ym1pdChoYXNoOiBzdHJpbmcsIGNvbG9yczogUmVhZG9ubHlBcnJheTxzdHJpbmc+KSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYC9hcGkvbGFiZWwvJHtoYXNofWAsIHtcbiAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBjb2xvcnMgfSksXG4gICAgfSk7XG5cbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcblxuICAgIGlmIChqc29uLmVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoanNvbi5lcnJvcik7XG4gICAgfVxuICB9XG59XG5cbmNvbnN0IGFwcCA9IG5ldyBBcHAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRlbnQnKSEpO1xuXG5hcHAucnVuKCkuY2F0Y2goKGUpID0+IHtcbiAgY29uc29sZS5lcnJvcihlKTtcbn0pO1xuIiwiKGZ1bmN0aW9uKHNlbGYpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGlmIChzZWxmLmZldGNoKSB7XG4gICAgcmV0dXJuXG4gIH1cblxuICB2YXIgc3VwcG9ydCA9IHtcbiAgICBzZWFyY2hQYXJhbXM6ICdVUkxTZWFyY2hQYXJhbXMnIGluIHNlbGYsXG4gICAgaXRlcmFibGU6ICdTeW1ib2wnIGluIHNlbGYgJiYgJ2l0ZXJhdG9yJyBpbiBTeW1ib2wsXG4gICAgYmxvYjogJ0ZpbGVSZWFkZXInIGluIHNlbGYgJiYgJ0Jsb2InIGluIHNlbGYgJiYgKGZ1bmN0aW9uKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbmV3IEJsb2IoKVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgIH0pKCksXG4gICAgZm9ybURhdGE6ICdGb3JtRGF0YScgaW4gc2VsZixcbiAgICBhcnJheUJ1ZmZlcjogJ0FycmF5QnVmZmVyJyBpbiBzZWxmXG4gIH1cblxuICBpZiAoc3VwcG9ydC5hcnJheUJ1ZmZlcikge1xuICAgIHZhciB2aWV3Q2xhc3NlcyA9IFtcbiAgICAgICdbb2JqZWN0IEludDhBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgVWludDhBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgVWludDhDbGFtcGVkQXJyYXldJyxcbiAgICAgICdbb2JqZWN0IEludDE2QXJyYXldJyxcbiAgICAgICdbb2JqZWN0IFVpbnQxNkFycmF5XScsXG4gICAgICAnW29iamVjdCBJbnQzMkFycmF5XScsXG4gICAgICAnW29iamVjdCBVaW50MzJBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgRmxvYXQzMkFycmF5XScsXG4gICAgICAnW29iamVjdCBGbG9hdDY0QXJyYXldJ1xuICAgIF1cblxuICAgIHZhciBpc0RhdGFWaWV3ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqICYmIERhdGFWaWV3LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKG9iailcbiAgICB9XG5cbiAgICB2YXIgaXNBcnJheUJ1ZmZlclZpZXcgPSBBcnJheUJ1ZmZlci5pc1ZpZXcgfHwgZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqICYmIHZpZXdDbGFzc2VzLmluZGV4T2YoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikpID4gLTFcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBub3JtYWxpemVOYW1lKG5hbWUpIHtcbiAgICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICBuYW1lID0gU3RyaW5nKG5hbWUpXG4gICAgfVxuICAgIGlmICgvW15hLXowLTlcXC0jJCUmJyorLlxcXl9gfH5dL2kudGVzdChuYW1lKSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBjaGFyYWN0ZXIgaW4gaGVhZGVyIGZpZWxkIG5hbWUnKVxuICAgIH1cbiAgICByZXR1cm4gbmFtZS50b0xvd2VyQ2FzZSgpXG4gIH1cblxuICBmdW5jdGlvbiBub3JtYWxpemVWYWx1ZSh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICB2YWx1ZSA9IFN0cmluZyh2YWx1ZSlcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlXG4gIH1cblxuICAvLyBCdWlsZCBhIGRlc3RydWN0aXZlIGl0ZXJhdG9yIGZvciB0aGUgdmFsdWUgbGlzdFxuICBmdW5jdGlvbiBpdGVyYXRvckZvcihpdGVtcykge1xuICAgIHZhciBpdGVyYXRvciA9IHtcbiAgICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBpdGVtcy5zaGlmdCgpXG4gICAgICAgIHJldHVybiB7ZG9uZTogdmFsdWUgPT09IHVuZGVmaW5lZCwgdmFsdWU6IHZhbHVlfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzdXBwb3J0Lml0ZXJhYmxlKSB7XG4gICAgICBpdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBpdGVyYXRvclxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBpdGVyYXRvclxuICB9XG5cbiAgZnVuY3Rpb24gSGVhZGVycyhoZWFkZXJzKSB7XG4gICAgdGhpcy5tYXAgPSB7fVxuXG4gICAgaWYgKGhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzKSB7XG4gICAgICBoZWFkZXJzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgdmFsdWUpXG4gICAgICB9LCB0aGlzKVxuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShoZWFkZXJzKSkge1xuICAgICAgaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKGhlYWRlcikge1xuICAgICAgICB0aGlzLmFwcGVuZChoZWFkZXJbMF0sIGhlYWRlclsxXSlcbiAgICAgIH0sIHRoaXMpXG4gICAgfSBlbHNlIGlmIChoZWFkZXJzKSB7XG4gICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgaGVhZGVyc1tuYW1lXSlcbiAgICAgIH0sIHRoaXMpXG4gICAgfVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICAgIHZhbHVlID0gbm9ybWFsaXplVmFsdWUodmFsdWUpXG4gICAgdmFyIG9sZFZhbHVlID0gdGhpcy5tYXBbbmFtZV1cbiAgICB0aGlzLm1hcFtuYW1lXSA9IG9sZFZhbHVlID8gb2xkVmFsdWUrJywnK3ZhbHVlIDogdmFsdWVcbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlWydkZWxldGUnXSA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBkZWxldGUgdGhpcy5tYXBbbm9ybWFsaXplTmFtZShuYW1lKV1cbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICAgIHJldHVybiB0aGlzLmhhcyhuYW1lKSA/IHRoaXMubWFwW25hbWVdIDogbnVsbFxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24obmFtZSkge1xuICAgIHJldHVybiB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShub3JtYWxpemVOYW1lKG5hbWUpKVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSA9IG5vcm1hbGl6ZVZhbHVlKHZhbHVlKVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgZm9yICh2YXIgbmFtZSBpbiB0aGlzLm1hcCkge1xuICAgICAgaWYgKHRoaXMubWFwLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdGhpcy5tYXBbbmFtZV0sIG5hbWUsIHRoaXMpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpdGVtcyA9IFtdXG4gICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7IGl0ZW1zLnB1c2gobmFtZSkgfSlcbiAgICByZXR1cm4gaXRlcmF0b3JGb3IoaXRlbXMpXG4gIH1cblxuICBIZWFkZXJzLnByb3RvdHlwZS52YWx1ZXMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaXRlbXMgPSBbXVxuICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSkgeyBpdGVtcy5wdXNoKHZhbHVlKSB9KVxuICAgIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlLmVudHJpZXMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaXRlbXMgPSBbXVxuICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkgeyBpdGVtcy5wdXNoKFtuYW1lLCB2YWx1ZV0pIH0pXG4gICAgcmV0dXJuIGl0ZXJhdG9yRm9yKGl0ZW1zKVxuICB9XG5cbiAgaWYgKHN1cHBvcnQuaXRlcmFibGUpIHtcbiAgICBIZWFkZXJzLnByb3RvdHlwZVtTeW1ib2wuaXRlcmF0b3JdID0gSGVhZGVycy5wcm90b3R5cGUuZW50cmllc1xuICB9XG5cbiAgZnVuY3Rpb24gY29uc3VtZWQoYm9keSkge1xuICAgIGlmIChib2R5LmJvZHlVc2VkKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcignQWxyZWFkeSByZWFkJykpXG4gICAgfVxuICAgIGJvZHkuYm9keVVzZWQgPSB0cnVlXG4gIH1cblxuICBmdW5jdGlvbiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKHJlYWRlci5yZXN1bHQpXG4gICAgICB9XG4gICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QocmVhZGVyLmVycm9yKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBmdW5jdGlvbiByZWFkQmxvYkFzQXJyYXlCdWZmZXIoYmxvYikge1xuICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgdmFyIHByb21pc2UgPSBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihibG9iKVxuICAgIHJldHVybiBwcm9taXNlXG4gIH1cblxuICBmdW5jdGlvbiByZWFkQmxvYkFzVGV4dChibG9iKSB7XG4gICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICB2YXIgcHJvbWlzZSA9IGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpXG4gICAgcmVhZGVyLnJlYWRBc1RleHQoYmxvYilcbiAgICByZXR1cm4gcHJvbWlzZVxuICB9XG5cbiAgZnVuY3Rpb24gcmVhZEFycmF5QnVmZmVyQXNUZXh0KGJ1Zikge1xuICAgIHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmKVxuICAgIHZhciBjaGFycyA9IG5ldyBBcnJheSh2aWV3Lmxlbmd0aClcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmlldy5sZW5ndGg7IGkrKykge1xuICAgICAgY2hhcnNbaV0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHZpZXdbaV0pXG4gICAgfVxuICAgIHJldHVybiBjaGFycy5qb2luKCcnKVxuICB9XG5cbiAgZnVuY3Rpb24gYnVmZmVyQ2xvbmUoYnVmKSB7XG4gICAgaWYgKGJ1Zi5zbGljZSkge1xuICAgICAgcmV0dXJuIGJ1Zi5zbGljZSgwKVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1Zi5ieXRlTGVuZ3RoKVxuICAgICAgdmlldy5zZXQobmV3IFVpbnQ4QXJyYXkoYnVmKSlcbiAgICAgIHJldHVybiB2aWV3LmJ1ZmZlclxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIEJvZHkoKSB7XG4gICAgdGhpcy5ib2R5VXNlZCA9IGZhbHNlXG5cbiAgICB0aGlzLl9pbml0Qm9keSA9IGZ1bmN0aW9uKGJvZHkpIHtcbiAgICAgIHRoaXMuX2JvZHlJbml0ID0gYm9keVxuICAgICAgaWYgKCFib2R5KSB7XG4gICAgICAgIHRoaXMuX2JvZHlUZXh0ID0gJydcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRoaXMuX2JvZHlUZXh0ID0gYm9keVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmJsb2IgJiYgQmxvYi5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5QmxvYiA9IGJvZHlcbiAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5mb3JtRGF0YSAmJiBGb3JtRGF0YS5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5Rm9ybURhdGEgPSBib2R5XG4gICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5VGV4dCA9IGJvZHkudG9TdHJpbmcoKVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIHN1cHBvcnQuYmxvYiAmJiBpc0RhdGFWaWV3KGJvZHkpKSB7XG4gICAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA9IGJ1ZmZlckNsb25lKGJvZHkuYnVmZmVyKVxuICAgICAgICAvLyBJRSAxMC0xMSBjYW4ndCBoYW5kbGUgYSBEYXRhVmlldyBib2R5LlxuICAgICAgICB0aGlzLl9ib2R5SW5pdCA9IG5ldyBCbG9iKFt0aGlzLl9ib2R5QXJyYXlCdWZmZXJdKVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIChBcnJheUJ1ZmZlci5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSB8fCBpc0FycmF5QnVmZmVyVmlldyhib2R5KSkpIHtcbiAgICAgICAgdGhpcy5fYm9keUFycmF5QnVmZmVyID0gYnVmZmVyQ2xvbmUoYm9keSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigndW5zdXBwb3J0ZWQgQm9keUluaXQgdHlwZScpXG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBib2R5ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICd0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLTgnKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlCbG9iICYmIHRoaXMuX2JvZHlCbG9iLnR5cGUpIHtcbiAgICAgICAgICB0aGlzLmhlYWRlcnMuc2V0KCdjb250ZW50LXR5cGUnLCB0aGlzLl9ib2R5QmxvYi50eXBlKVxuICAgICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCcpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoc3VwcG9ydC5ibG9iKSB7XG4gICAgICB0aGlzLmJsb2IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICAgICAgcmV0dXJuIHJlamVjdGVkXG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fYm9keUJsb2IpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlCbG9iKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlBcnJheUJ1ZmZlcl0pKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyBibG9iJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFt0aGlzLl9ib2R5VGV4dF0pKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYXJyYXlCdWZmZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICAgIHJldHVybiBjb25zdW1lZCh0aGlzKSB8fCBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keUFycmF5QnVmZmVyKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB0aGlzLmJsb2IoKS50aGVuKHJlYWRCbG9iQXNBcnJheUJ1ZmZlcilcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMudGV4dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgICByZXR1cm4gcmVqZWN0ZWRcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgIHJldHVybiByZWFkQmxvYkFzVGV4dCh0aGlzLl9ib2R5QmxvYilcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUFycmF5QnVmZmVyKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVhZEFycmF5QnVmZmVyQXNUZXh0KHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCByZWFkIEZvcm1EYXRhIGJvZHkgYXMgdGV4dCcpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlUZXh0KVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzdXBwb3J0LmZvcm1EYXRhKSB7XG4gICAgICB0aGlzLmZvcm1EYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHQoKS50aGVuKGRlY29kZSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmpzb24gPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnRleHQoKS50aGVuKEpTT04ucGFyc2UpXG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8vIEhUVFAgbWV0aG9kcyB3aG9zZSBjYXBpdGFsaXphdGlvbiBzaG91bGQgYmUgbm9ybWFsaXplZFxuICB2YXIgbWV0aG9kcyA9IFsnREVMRVRFJywgJ0dFVCcsICdIRUFEJywgJ09QVElPTlMnLCAnUE9TVCcsICdQVVQnXVxuXG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZU1ldGhvZChtZXRob2QpIHtcbiAgICB2YXIgdXBjYXNlZCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpXG4gICAgcmV0dXJuIChtZXRob2RzLmluZGV4T2YodXBjYXNlZCkgPiAtMSkgPyB1cGNhc2VkIDogbWV0aG9kXG4gIH1cblxuICBmdW5jdGlvbiBSZXF1ZXN0KGlucHV0LCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge31cbiAgICB2YXIgYm9keSA9IG9wdGlvbnMuYm9keVxuXG4gICAgaWYgKGlucHV0IGluc3RhbmNlb2YgUmVxdWVzdCkge1xuICAgICAgaWYgKGlucHV0LmJvZHlVc2VkKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FscmVhZHkgcmVhZCcpXG4gICAgICB9XG4gICAgICB0aGlzLnVybCA9IGlucHV0LnVybFxuICAgICAgdGhpcy5jcmVkZW50aWFscyA9IGlucHV0LmNyZWRlbnRpYWxzXG4gICAgICBpZiAoIW9wdGlvbnMuaGVhZGVycykge1xuICAgICAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhpbnB1dC5oZWFkZXJzKVxuICAgICAgfVxuICAgICAgdGhpcy5tZXRob2QgPSBpbnB1dC5tZXRob2RcbiAgICAgIHRoaXMubW9kZSA9IGlucHV0Lm1vZGVcbiAgICAgIGlmICghYm9keSAmJiBpbnB1dC5fYm9keUluaXQgIT0gbnVsbCkge1xuICAgICAgICBib2R5ID0gaW5wdXQuX2JvZHlJbml0XG4gICAgICAgIGlucHV0LmJvZHlVc2VkID0gdHJ1ZVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnVybCA9IFN0cmluZyhpbnB1dClcbiAgICB9XG5cbiAgICB0aGlzLmNyZWRlbnRpYWxzID0gb3B0aW9ucy5jcmVkZW50aWFscyB8fCB0aGlzLmNyZWRlbnRpYWxzIHx8ICdvbWl0J1xuICAgIGlmIChvcHRpb25zLmhlYWRlcnMgfHwgIXRoaXMuaGVhZGVycykge1xuICAgICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICAgIH1cbiAgICB0aGlzLm1ldGhvZCA9IG5vcm1hbGl6ZU1ldGhvZChvcHRpb25zLm1ldGhvZCB8fCB0aGlzLm1ldGhvZCB8fCAnR0VUJylcbiAgICB0aGlzLm1vZGUgPSBvcHRpb25zLm1vZGUgfHwgdGhpcy5tb2RlIHx8IG51bGxcbiAgICB0aGlzLnJlZmVycmVyID0gbnVsbFxuXG4gICAgaWYgKCh0aGlzLm1ldGhvZCA9PT0gJ0dFVCcgfHwgdGhpcy5tZXRob2QgPT09ICdIRUFEJykgJiYgYm9keSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQm9keSBub3QgYWxsb3dlZCBmb3IgR0VUIG9yIEhFQUQgcmVxdWVzdHMnKVxuICAgIH1cbiAgICB0aGlzLl9pbml0Qm9keShib2R5KVxuICB9XG5cbiAgUmVxdWVzdC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFJlcXVlc3QodGhpcywgeyBib2R5OiB0aGlzLl9ib2R5SW5pdCB9KVxuICB9XG5cbiAgZnVuY3Rpb24gZGVjb2RlKGJvZHkpIHtcbiAgICB2YXIgZm9ybSA9IG5ldyBGb3JtRGF0YSgpXG4gICAgYm9keS50cmltKCkuc3BsaXQoJyYnKS5mb3JFYWNoKGZ1bmN0aW9uKGJ5dGVzKSB7XG4gICAgICBpZiAoYnl0ZXMpIHtcbiAgICAgICAgdmFyIHNwbGl0ID0gYnl0ZXMuc3BsaXQoJz0nKVxuICAgICAgICB2YXIgbmFtZSA9IHNwbGl0LnNoaWZ0KCkucmVwbGFjZSgvXFwrL2csICcgJylcbiAgICAgICAgdmFyIHZhbHVlID0gc3BsaXQuam9pbignPScpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgIGZvcm0uYXBwZW5kKGRlY29kZVVSSUNvbXBvbmVudChuYW1lKSwgZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKSlcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiBmb3JtXG4gIH1cblxuICBmdW5jdGlvbiBwYXJzZUhlYWRlcnMocmF3SGVhZGVycykge1xuICAgIHZhciBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKVxuICAgIC8vIFJlcGxhY2UgaW5zdGFuY2VzIG9mIFxcclxcbiBhbmQgXFxuIGZvbGxvd2VkIGJ5IGF0IGxlYXN0IG9uZSBzcGFjZSBvciBob3Jpem9udGFsIHRhYiB3aXRoIGEgc3BhY2VcbiAgICAvLyBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjNzIzMCNzZWN0aW9uLTMuMlxuICAgIHZhciBwcmVQcm9jZXNzZWRIZWFkZXJzID0gcmF3SGVhZGVycy5yZXBsYWNlKC9cXHI/XFxuW1xcdCBdKy9nLCAnICcpXG4gICAgcHJlUHJvY2Vzc2VkSGVhZGVycy5zcGxpdCgvXFxyP1xcbi8pLmZvckVhY2goZnVuY3Rpb24obGluZSkge1xuICAgICAgdmFyIHBhcnRzID0gbGluZS5zcGxpdCgnOicpXG4gICAgICB2YXIga2V5ID0gcGFydHMuc2hpZnQoKS50cmltKClcbiAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gcGFydHMuam9pbignOicpLnRyaW0oKVxuICAgICAgICBoZWFkZXJzLmFwcGVuZChrZXksIHZhbHVlKVxuICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIGhlYWRlcnNcbiAgfVxuXG4gIEJvZHkuY2FsbChSZXF1ZXN0LnByb3RvdHlwZSlcblxuICBmdW5jdGlvbiBSZXNwb25zZShib2R5SW5pdCwgb3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgb3B0aW9ucyA9IHt9XG4gICAgfVxuXG4gICAgdGhpcy50eXBlID0gJ2RlZmF1bHQnXG4gICAgdGhpcy5zdGF0dXMgPSBvcHRpb25zLnN0YXR1cyA9PT0gdW5kZWZpbmVkID8gMjAwIDogb3B0aW9ucy5zdGF0dXNcbiAgICB0aGlzLm9rID0gdGhpcy5zdGF0dXMgPj0gMjAwICYmIHRoaXMuc3RhdHVzIDwgMzAwXG4gICAgdGhpcy5zdGF0dXNUZXh0ID0gJ3N0YXR1c1RleHQnIGluIG9wdGlvbnMgPyBvcHRpb25zLnN0YXR1c1RleHQgOiAnT0snXG4gICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICAgIHRoaXMudXJsID0gb3B0aW9ucy51cmwgfHwgJydcbiAgICB0aGlzLl9pbml0Qm9keShib2R5SW5pdClcbiAgfVxuXG4gIEJvZHkuY2FsbChSZXNwb25zZS5wcm90b3R5cGUpXG5cbiAgUmVzcG9uc2UucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZSh0aGlzLl9ib2R5SW5pdCwge1xuICAgICAgc3RhdHVzOiB0aGlzLnN0YXR1cyxcbiAgICAgIHN0YXR1c1RleHQ6IHRoaXMuc3RhdHVzVGV4dCxcbiAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHRoaXMuaGVhZGVycyksXG4gICAgICB1cmw6IHRoaXMudXJsXG4gICAgfSlcbiAgfVxuXG4gIFJlc3BvbnNlLmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJlc3BvbnNlID0gbmV3IFJlc3BvbnNlKG51bGwsIHtzdGF0dXM6IDAsIHN0YXR1c1RleHQ6ICcnfSlcbiAgICByZXNwb25zZS50eXBlID0gJ2Vycm9yJ1xuICAgIHJldHVybiByZXNwb25zZVxuICB9XG5cbiAgdmFyIHJlZGlyZWN0U3RhdHVzZXMgPSBbMzAxLCAzMDIsIDMwMywgMzA3LCAzMDhdXG5cbiAgUmVzcG9uc2UucmVkaXJlY3QgPSBmdW5jdGlvbih1cmwsIHN0YXR1cykge1xuICAgIGlmIChyZWRpcmVjdFN0YXR1c2VzLmluZGV4T2Yoc3RhdHVzKSA9PT0gLTEpIHtcbiAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIHN0YXR1cyBjb2RlJylcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKG51bGwsIHtzdGF0dXM6IHN0YXR1cywgaGVhZGVyczoge2xvY2F0aW9uOiB1cmx9fSlcbiAgfVxuXG4gIHNlbGYuSGVhZGVycyA9IEhlYWRlcnNcbiAgc2VsZi5SZXF1ZXN0ID0gUmVxdWVzdFxuICBzZWxmLlJlc3BvbnNlID0gUmVzcG9uc2VcblxuICBzZWxmLmZldGNoID0gZnVuY3Rpb24oaW5wdXQsIGluaXQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KGlucHV0LCBpbml0KVxuICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpXG5cbiAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgc3RhdHVzOiB4aHIuc3RhdHVzLFxuICAgICAgICAgIHN0YXR1c1RleHQ6IHhoci5zdGF0dXNUZXh0LFxuICAgICAgICAgIGhlYWRlcnM6IHBhcnNlSGVhZGVycyh4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgfHwgJycpXG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9ucy51cmwgPSAncmVzcG9uc2VVUkwnIGluIHhociA/IHhoci5yZXNwb25zZVVSTCA6IG9wdGlvbnMuaGVhZGVycy5nZXQoJ1gtUmVxdWVzdC1VUkwnKVxuICAgICAgICB2YXIgYm9keSA9ICdyZXNwb25zZScgaW4geGhyID8geGhyLnJlc3BvbnNlIDogeGhyLnJlc3BvbnNlVGV4dFxuICAgICAgICByZXNvbHZlKG5ldyBSZXNwb25zZShib2R5LCBvcHRpb25zKSlcbiAgICAgIH1cblxuICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQnKSlcbiAgICAgIH1cblxuICAgICAgeGhyLm9udGltZW91dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcignTmV0d29yayByZXF1ZXN0IGZhaWxlZCcpKVxuICAgICAgfVxuXG4gICAgICB4aHIub3BlbihyZXF1ZXN0Lm1ldGhvZCwgcmVxdWVzdC51cmwsIHRydWUpXG5cbiAgICAgIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnaW5jbHVkZScpIHtcbiAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWVcbiAgICAgIH0gZWxzZSBpZiAocmVxdWVzdC5jcmVkZW50aWFscyA9PT0gJ29taXQnKSB7XG4gICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSBmYWxzZVxuICAgICAgfVxuXG4gICAgICBpZiAoJ3Jlc3BvbnNlVHlwZScgaW4geGhyICYmIHN1cHBvcnQuYmxvYikge1xuICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InXG4gICAgICB9XG5cbiAgICAgIHJlcXVlc3QuaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKVxuICAgICAgfSlcblxuICAgICAgeGhyLnNlbmQodHlwZW9mIHJlcXVlc3QuX2JvZHlJbml0ID09PSAndW5kZWZpbmVkJyA/IG51bGwgOiByZXF1ZXN0Ll9ib2R5SW5pdClcbiAgICB9KVxuICB9XG4gIHNlbGYuZmV0Y2gucG9seWZpbGwgPSB0cnVlXG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcyk7XG4iXSwic291cmNlUm9vdCI6IiJ9